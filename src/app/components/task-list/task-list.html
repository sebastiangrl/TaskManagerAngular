<div class="task-list-container">
  <div class="list-header">
    <svg class="icon" viewBox="0 0 24 24" data-tooltip="Tus tareas">
      <path d="M9 11l3 3L22 4"></path>
      <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
    </svg>
    <h2>Tareas</h2>
  </div>

  @if (tasks$ | async; as tasks) {
  @if (tasks.length === 0) {
  <div class="empty-state">
    <svg class="icon-lg empty-icon" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="8" y1="12" x2="16" y2="12"></line>
    </svg>
    <p class="empty-title">No hay tareas aún</p>
    <p class="empty-subtitle">Crea tu primera tarea para comenzar</p>
  </div>
  } @else {
  <div class="tasks-grid">
    @for (task of tasks; track task.id) {
    <div class="task-card" [class.completed]="task.completed">
      <div class="task-header">
        <div class="task-status-badge" [class.completed]="task.completed"
          [attr.data-tooltip]="task.completed ? 'Completada' : 'Pendiente'">
          @if (task.completed) {
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          } @else {
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"></circle>
          </svg>
          }
        </div>
        <h3>{{ task.title }}</h3>
      </div>

      <p class="task-description">{{ task.description }}</p>

      <div class="task-meta">
        <div class="task-date" data-tooltip="Fecha de creación">
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
          <span>{{ task.createdAt | date:'d MMM, y':'':'es' }}</span>
        </div>
      </div>

      <div class="task-actions">
        <button class="btn-toggle" (click)="onToggleTask(task.id)" [class.completed]="task.completed"
          [attr.data-tooltip]="task.completed ? 'Marcar como incompleta' : 'Marcar como completa'">
          @if (task.completed) {
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <polyline points="1 4 1 10 7 10"></polyline>
            <polyline points="23 20 23 14 17 14"></polyline>
            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
          </svg>
          <span>Deshacer</span>
          } @else {
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          <span>Completar</span>
          }
        </button>

        <button class="btn-delete" (click)="onDeleteTask(task.id)" data-tooltip="Eliminar tarea">
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
          <span>Eliminar</span>
        </button>
      </div>
    </div>
    }
  </div>
  }
  }
</div>